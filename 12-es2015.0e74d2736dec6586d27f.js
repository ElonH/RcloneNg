(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{LYUz:function(t,n,e){"use strict";e.r(n),e.d(n,"MountsModule",(function(){return k}));var i=e("ofXK"),o=e("FTbq"),c=e("aceb"),s=e("3Pt+"),u=e("tyNb"),r=e("wd/R"),l=e("LRne"),a=e("lJxs"),h=e("fXoL"),m=e("XNiG"),d=e("itXk"),p=e("JYL7"),g=e("L7Zs");let f=(()=>{class t{constructor(t){this.connectService=t,this.listTrigger=new m.a,this.addTrigger=new m.a,this.unmountTrigger=new m.a,this.unmountAllTrigger=new m.a;const n=this;this.list$=new class extends p.k{constructor(){super(...arguments),this.prerequest$=Object(d.a)([n.listTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>n)}},this.list$.deploy(),this.add$=new class extends p.m{constructor(){super(...arguments),this.prerequest$=Object(d.a)([n.addTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>[Object.assign(Object.assign({},n[0]),t),n[1]])}},this.add$.deploy(),this.add$.getOutput().subscribe(t=>{0===t[1].length&&this.refreshList()}),this.unmount$=new class extends p.o{constructor(){super(...arguments),this.prerequest$=Object(d.a)([n.unmountTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>[Object.assign(Object.assign({},n[0]),t),n[1]])}},this.unmount$.deploy(),this.unmount$.getOutput().subscribe(t=>{0===t[1].length&&this.refreshList()}),this.unmountAll$=new class extends p.n{constructor(){super(...arguments),this.prerequest$=Object(d.a)([n.unmountAllTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>n)}},this.unmountAll$.deploy(),this.unmountAll$.getOutput().subscribe(t=>{0===t[1].length&&this.refreshList()})}refreshList(){this.list$.clearCache(),this.listTrigger.next(1)}mount(t){this.addTrigger.next(t)}unmount(t){this.unmountTrigger.next(t)}unmountAll(){this.unmountAllTrigger.next(1)}}return t.\u0275fac=function(n){return new(n||t)(h.ic(g.a))},t.\u0275prov=h.Ub({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=e("x0Mr");const M=["mountTypeInp"];function y(t,n){if(1&t){const t=h.fc();h.ec(0,"td"),h.Uc(1),h.dc(),h.ec(2,"td"),h.Uc(3),h.dc(),h.ec(4,"td"),h.Uc(5),h.dc(),h.ec(6,"td"),h.ec(7,"button",5),h.mc("click",(function(){h.Kc(t);const e=n.$implicit;return h.oc().unmount(e)})),h.Zb(8,"nb-icon",6),h.dc(),h.dc()}if(2&t){const t=n.$implicit;h.Mb(1),h.Vc(t.Fs),h.Mb(2),h.Vc(t.MountPoint),h.Mb(2),h.Vc(t.MountedTimeHumanReadable)}}function w(t,n){if(1&t&&(h.ec(0,"nb-option",16),h.Uc(1),h.dc()),2&t){const t=n.$implicit;h.wc("value",t),h.Mb(1),h.Wc(" ",t," ")}}function v(t,n){if(1&t){const t=h.fc();h.ec(0,"th"),h.ec(1,"input",7),h.mc("ngModelChange",(function(n){return h.Kc(t),h.oc().newMount.fs=n})),h.dc(),h.dc(),h.ec(2,"th"),h.ec(3,"input",8),h.mc("ngModelChange",(function(n){return h.Kc(t),h.oc().newMount.mountPoint=n})),h.dc(),h.dc(),h.ec(4,"th"),h.ec(5,"input",9,10),h.mc("input",(function(){return h.Kc(t),h.oc().onMountTypeInpChange()})),h.dc(),h.ec(7,"nb-autocomplete",11,12),h.mc("selectedChange",(function(n){return h.Kc(t),h.oc().onMountTypeInpSecChange(n)})),h.Sc(9,w,2,2,"nb-option",13),h.pc(10,"async"),h.dc(),h.dc(),h.ec(11,"th"),h.ec(12,"button",14),h.mc("click",(function(){return h.Kc(t),h.oc().mount()})),h.Zb(13,"nb-icon",15),h.dc(),h.dc()}if(2&t){const t=h.Gc(8),n=h.oc();h.Mb(1),h.wc("ngModel",n.newMount.fs),h.Mb(2),h.wc("ngModel",n.newMount.mountPoint),h.Mb(2),h.wc("nbAutocomplete",t),h.Mb(4),h.wc("ngForOf",h.qc(10,4,n.filteredOptions$))}}const O=function(t){return{"infinte-rotate":t}},T=[{path:"",component:(()=>{class t{constructor(t,n,e){this.mountService=t,this.toastr=n,this.modal=e,this.scrb=[],this.columns=[{key:"Fs",title:"Filesystem",width:"37.5%"},{key:"MountPoint",title:"Mounted point",width:"37.5%"},{key:"MountedTimeHumanReadable",title:"Mounted time",width:"20%"},{key:"",title:"Action",width:"5%"}],this.data=[],this.newMount={fs:"",mountPoint:"",mountType:""}}filter(t){const n=t.toLowerCase();return this.options.filter(t=>t.toLowerCase().includes(n))}getFilteredOptions(t){return Object(l.a)(t).pipe(Object(a.a)(t=>this.filter(t)))}onMountTypeInpChange(){this.newMount.mountType=this.mountTypeInp.nativeElement.value,this.filteredOptions$=this.getFilteredOptions(this.mountTypeInp.nativeElement.value)}onMountTypeInpSecChange(t){this.filteredOptions$=this.getFilteredOptions(t)}refresh(){this.mountService.refreshList()}mount(){this.mountService.mount(this.newMount)}unmount(t){this.unmountItem=t,this.mountService.unmount({mountPoint:t.MountPoint})}unmountAll(){this.modal.confirm().className("flat-attack").message("Unmount all activated mounts?").isBlocking(!1).open().result.then(t=>{t&&this.mountService.unmountAll()},()=>{})}ngOnInit(){this.configuration=Object.assign({},o.c),this.configuration.searchEnabled=!1,this.configuration.isLoading=!0,this.options=["mount","cmount","mount2"],this.filteredOptions$=Object(l.a)(this.options),this.scrb.push(this.mountService.list$.getOutput().subscribe(t=>{this.configuration.isLoading=!1,0===t[1].length?this.data=t[0].mountPoints.map(t=>Object.assign(Object.assign({},t),{MountedTimeHumanReadable:r(t.MountedOn).fromNow()})):this.toastr.danger(t[1].join(" \n"),"fetch mounts list failure",{icon:"list-tree",iconPack:"css.gg",destroyByClick:!0,duration:0})})),this.scrb.push(this.mountService.add$.getOutput().subscribe(t=>{0===t[1].length||this.toastr.danger(t[1].join(" \n"),"Create mount point failure",{icon:"alert-triangle-outline"})})),this.scrb.push(this.mountService.unmount$.getOutput().subscribe(t=>{0===t[1].length?(this.newMount.fs=this.unmountItem.Fs,this.newMount.mountPoint=this.unmountItem.MountPoint,this.newMount.mountType="",this.toastr.success(this.unmountItem.MountPoint,"Unmount actived mount successfully",{icon:"checkmark-circle-outline"})):this.toastr.danger(t[1].join(" \n"),"Unmount actived mount failure",{icon:"alert-triangle-outline"})})),this.scrb.push(this.mountService.unmountAll$.getOutput().subscribe(t=>{0===t[1].length?this.toastr.success("","Unmount all mounts successfully",{icon:"checkmark-circle-outline"}):this.toastr.danger(t[1].join(" \n"),"Unmount all mounts failure",{icon:"alert-triangle-outline"})})),this.refresh()}ngOnDestroy(){this.scrb.forEach(t=>t.unsubscribe()),this.scrb=[]}}return t.\u0275fac=function(n){return new(n||t)(h.Yb(f),h.Yb(c.ib),h.Yb(b.a))},t.\u0275cmp=h.Sb({type:t,selectors:[["app-mounts"]],viewQuery:function(t,n){var e;1&t&&h.Zc(M,!0),2&t&&h.Fc(e=h.nc())&&(n.mountTypeInp=e.first)},decls:11,vars:7,consts:[[1,"push-to-right"],["icon","trash-2-outline",3,"click"],["icon","sync",3,"ngClass","click"],[3,"configuration","data","columns","filtersTemplate"],["filtersTemplate",""],["nbButton","","status","danger","size","small",3,"click"],["icon","close-outline"],["type","text","nbInput","","fullWidth","","fieldSize","small","placeholder","remote path to be mounted ([remote]:[path])",3,"ngModel","ngModelChange"],["type","text","nbInput","","fullWidth","","fieldSize","small","placeholder","path on server machine",3,"ngModel","ngModelChange"],["nbInput","","type","text","fullWidth","","fieldSize","small","placeholder","mount type",3,"nbAutocomplete","input"],["mountTypeInp",""],[3,"selectedChange"],["auto",""],[3,"value",4,"ngFor","ngForOf"],["nbButton","","status","info","size","small",3,"click"],["icon","plus-outline"],[3,"value"]],template:function(t,n){if(1&t&&(h.ec(0,"nb-card"),h.ec(1,"nb-card-header"),h.Uc(2," Mount Point Manager "),h.ec(3,"nb-actions",0),h.ec(4,"nb-action",1),h.mc("click",(function(){return n.unmountAll()})),h.dc(),h.ec(5,"nb-action",2),h.mc("click",(function(){return n.refresh()})),h.dc(),h.dc(),h.dc(),h.ec(6,"nb-card-body"),h.ec(7,"ngx-table",3),h.Sc(8,y,9,3,"ng-template"),h.dc(),h.dc(),h.dc(),h.Sc(9,v,14,6,"ng-template",null,4,h.Tc)),2&t){const t=h.Gc(10);h.Mb(5),h.wc("ngClass",h.Ac(5,O,n.configuration.isLoading)),h.Mb(2),h.wc("configuration",n.configuration)("data",n.data)("columns",n.columns)("filtersTemplate",t)}},directives:[c.r,c.u,c.g,c.f,i.l,c.q,o.b,c.n,c.C,c.F,s.a,s.e,s.h,c.j,c.i,i.n,c.R],pipes:[i.b],styles:["nb-card-header[_ngcontent-%COMP%] {\n\t\t\t\tdisplay: flex;\n\t\t\t}\n\t\t\t.push-to-right[_ngcontent-%COMP%] {\n\t\t\t\tmargin-left: auto;\n\t\t\t}"]}),t})()}];let $=(()=>{class t{}return t.\u0275mod=h.Wb({type:t}),t.\u0275inj=h.Vb({factory:function(n){return new(n||t)},imports:[[u.g.forChild(T)],u.g]}),t})(),k=(()=>{class t{}return t.\u0275mod=h.Wb({type:t}),t.\u0275inj=h.Vb({factory:function(n){return new(n||t)},imports:[[i.c,$,o.d,c.v,c.E,c.G,c.k,c.o,s.b,c.h]]}),t})()}}]);